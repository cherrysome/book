// Google Apps Script 코드 (Google Sheets에 저장되도록 처리)
function doPost(e) {
  try {
    const sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("시트1");
    const params = JSON.parse(e.postData.contents);

    const reservations = params.reservations || [];
    reservations.forEach(function (res) {
      sheet.appendRow(res);
    });

    const output = ContentService.createTextOutput("Success");
    const response = output.setMimeType(ContentService.MimeType.TEXT);
    response.getHeaders = () => ({
      "Access-Control-Allow-Origin": "*",
      "Access-Control-Allow-Methods": "POST, GET, OPTIONS",
      "Access-Control-Allow-Headers": "Content-Type"
    });
    return response;
  } catch (f) {
    const output = ContentService.createTextOutput("Error: " + f);
    const response = output.setMimeType(ContentService.MimeType.TEXT);
    response.getHeaders = () => ({
      "Access-Control-Allow-Origin": "*"
    });
    return response;
  }
}

function doOptions(e) {
  const output = ContentService.createTextOutput("");
  const response = output.setMimeType(ContentService.MimeType.TEXT);
  response.getHeaders = () => ({
    "Access-Control-Allow-Origin": "*",
    "Access-Control-Allow-Methods": "POST, GET, OPTIONS",
    "Access-Control-Allow-Headers": "Content-Type"
  });
  return response;
}

function doGet(e) {
  const output = ContentService.createTextOutput("Hello");
  const response = output.setMimeType(ContentService.MimeType.TEXT);
  response.getHeaders = () => ({
    "Access-Control-Allow-Origin": "*"
  });
  return response;
}
